pipeline {
    agent any

    tools {
        // Install the Maven version configured as "M3" and add it to the path.
        maven "mymaven"
    }

    stages {
        stage('clone'){
            steps{
                echo'cloning'
                git branch:'master',url:'https://github.com/abhinavvv2004/DevOpsClassCodes.git/'
            }
        }
        stage('compile'){
            steps{
                echo'compiling'
                sh'mvn clean compile'
            }
        }
        stage('code review'){
            steps{
                echo'running pmd'
                sh'mvn pmd:pmd'
            }
        }
        stage('unit test'){
           steps{
               echo'testing'
               sh'mvn test'

           }
      }
      stage('package'){
         steps{
             echo'packaging'
             sh'mvn package'
             archiveArtifacts artifacts:'**/*.war',fingerprint:true
          }
      }
       stage('deploy to QA'){
    steps{
        echo 'deploying to tomcat'
        deploy adapters: [
            tomcat9(
                credentialsId: 'tomcati',
                path: '',
                url: 'http://3.110.202.29:8080'
            )
        ],
        contextPath: '/qaenv',
        war: '/*.war'
    }
}
    }
}
